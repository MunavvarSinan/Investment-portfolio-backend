{"version":3,"sources":["../../src/config/passport.js"],"names":["initPassport","opts","jwtFromRequest","ExtractJwt","fromAuthHeaderWithScheme","secretOrKey","process","env","SECRET","passport","use","JwtStrategy","jwtPayload","done","User","findById","_doc","_id","user"],"mappings":";;;;;;;;;;;;;;;AAAA;;;;AACA;;AAEA;;;;;;AAEO,IAAMA,sCAAe,SAAfA,YAAe,GAAM;AAChC,MAAMC,OAAO;AACXC,oBAAgBC,wBAAWC,wBAAX,CAAoC,KAApC,CADL;AAEXC,iBAAaC,QAAQC,GAAR,CAAYC;AAFd,GAAb;;AAKAC,qBAASC,GAAT,CACE,IAAIC,qBAAJ,CAAgBV,IAAhB;AAAA,wFAAsB,iBAAOW,UAAP,EAAmBC,IAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAECC,eAAKC,QAAL,CAAcH,WAAWI,IAAX,CAAgBC,GAA9B,CAFD;;AAAA;AAEZC,kBAFY;;AAAA,mBAIdA,IAJc;AAAA;AAAA;AAAA;;AAAA,+CAKTL,KAAK,IAAL,EAAWK,IAAX,CALS;;AAAA;AAAA,+CAOXL,KAAK,IAAL,EAAW,KAAX,CAPW;;AAAA;AAAA;AAAA;AAAA,+CASXA,kBAAU,KAAV,CATW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAtB;;AAAA;AAAA;AAAA;AAAA,MADF;;AAeA;AACD,CAtBM","file":"passport.js","sourcesContent":["import passport from 'passport';\r\nimport { ExtractJwt, Strategy as JwtStrategy } from 'passport-jwt';\r\n\r\nimport User from '../models/user.js';\r\n\r\nexport const initPassport = () => {\r\n  const opts = {\r\n    jwtFromRequest: ExtractJwt.fromAuthHeaderWithScheme('jwt'),\r\n    secretOrKey: process.env.SECRET,\r\n  };\r\n\r\n  passport.use(\r\n    new JwtStrategy(opts, async (jwtPayload, done) => {\r\n      try {\r\n        const user = await User.findById(jwtPayload._doc._id);\r\n\r\n        if (user) {\r\n          return done(null, user);\r\n        }\r\n        return done(null, false);\r\n      } catch (err) {\r\n        return done(err, false);\r\n      }\r\n    })\r\n  );\r\n\r\n  // const serverUrl = process.env.SERVER_URL;\r\n};\r\n"]}