{"version":3,"sources":["../../src/config/safeRoutes.js"],"names":["checkToken","req","res","next","token","String","headers","authorization","ActiveSession","find","_err","session","length","json","success","msg"],"mappings":";;;;;;;AACA;;;;;;AAEA;AACO,IAAMA,kCAAa,SAAbA,UAAa,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC5C,MAAMC,QAAQC,OAAOJ,IAAIK,OAAJ,CAAYC,aAAnB,CAAd;AACAC,0BAAcC,IAAd,CAAmB,EAAEL,YAAF,EAAnB,EAA8B,UAACM,IAAD,EAAOC,OAAP,EAAmB;AAC/C,QAAIA,QAAQC,MAAR,KAAmB,CAAvB,EAA0B;AACxB,aAAOT,MAAP;AACD;AACD,WAAOD,IAAIW,IAAJ,CAAS,EAAEC,SAAS,KAAX,EAAkBC,KAAK,uBAAvB,EAAT,CAAP;AACD,GALD;AAMD,CARM","file":"safeRoutes.js","sourcesContent":["\r\nimport ActiveSession from '../models/activeSession.js';\r\n\r\n// eslint-disable-next-line import/prefer-default-export\r\nexport const checkToken = (req, res, next) => {\r\n  const token = String(req.headers.authorization);\r\n  ActiveSession.find({ token }, (_err, session) => {\r\n    if (session.length === 1) {\r\n      return next();\r\n    }\r\n    return res.json({ success: false, msg: 'User is not logged on' });\r\n  });\r\n};\r\n"]}